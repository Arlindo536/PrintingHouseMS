<svg width="1500" height="1200" viewBox="0 0 00 1200" xmlns="http://www.w3.org/2000/svg" font-family="Arial, sans-serif" font-size="12">
    <style>
        /* Node Styles */
        .node-box {
            stroke: #2c3e50;
            stroke-width: 2;
            fill: #e0e6ec; /* Light blue-grey */
            border-radius: 8px;
        }
        .node-header-bg {
            fill: #34495e; /* Dark blue-grey */
        }
        .node-header-text {
            fill: white;
            font-weight: bold;
            font-size: 15px;
        }
        .node-label {
            fill: #2c3e50;
            font-weight: bold;
            font-size: 13px;
        }

        /* Component Styles (inside nodes) */
        .component-box {
            stroke: #7f8c8d;
            stroke-width: 1;
            fill: #f2f4f6; /* Lighter grey */
            border-radius: 4px;
        }
        .component-text {
            fill: #2c3e50;
            font-size: 11px;
        }

        /* Database Styles */
        .db-container {
            stroke: #27ae60; /* Green */
            stroke-width: 2;
            fill: #ebf5ee; /* Light green */
            border-radius: 8px;
        }
        .db-text {
            fill: #27ae60;
            font-weight: bold;
            font-size: 13px;
        }
        .db-icon {
            fill: #27ae60;
        }

        /* Cloud Storage Styles */
        .cloud-storage-container {
            stroke: #3498db; /* Blue */
            stroke-width: 2;
            fill: #e8f3fa; /* Light blue */
            border-radius: 8px;
        }
        .cloud-storage-text {
            fill: #3498db;
            font-weight: bold;
            font-size: 13px;
        }
        .cloud-icon {
            fill: #3498db;
        }

        /* External Service Styles */
        .external-service-box {
            stroke: #9b59b6; /* Purple */
            stroke-width: 1.5;
            fill: #f4e8f7; /* Light purple */
            border-radius: 4px;
        }
        .external-service-text {
            fill: #9b59b6;
            font-weight: bold;
            font-size: 11px;
        }

        /* Connections */
        .connection-line {
            stroke: #34495e;
            stroke-width: 1.5;
            marker-end: url(#arrowhead);
            fill: none;
        }
        .connection-label {
            fill: #34495e;
            font-size: 10px;
            text-anchor: middle;
        }
    </style>

    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
        </marker>
        <g id="cloud-icon">
            <path d="M50,15 Q30,15 30,35 Q30,55 50,55 H80 Q100,55 100,35 Q100,15 80,15 Z" fill="#3498db" stroke="none"/>
            <circle cx="45" cy="40" r="15" fill="white"/>
            <circle cx="70" cy="30" r="10" fill="white"/>
            <circle cx="85" cy="45" r="12" fill="white"/>
        </g>
        <g id="db-icon">
            <ellipse cx="50" cy="15" rx="30" ry="10" fill="#27ae60"/>
            <rect x="20" y="15" width="60" height="40" fill="#27ae60"/>
            <ellipse cx="50" cy="55" rx="30" ry="10" fill="#27ae60"/>
            <path d="M20,15 L20,55 M80,15 L80,55" stroke="white" stroke-width="1" fill="none"/>
        </g>
        <g id="server-rack-icon">
            <rect x="20" y="10" width="60" height="40" fill="#7f8c8d" rx="3" ry="3"/>
            <rect x="25" y="15" width="50" height="8" fill="#bdc3c7"/>
            <rect x="25" y="27" width="50" height="8" fill="#bdc3c7"/>
            <rect x="25" y="39" width="50" height="8" fill="#bdc3c7"/>
            <line x1="20" y1="10" x2="20" y2="50" stroke="#7f8c8d" stroke-width="2"/>
            <line x1="80" y1="10" x2="80" y2="50" stroke="#7f8c8d" stroke-width="2"/>
        </g>
    </defs>

    <rect x="50" y="50" width="200" height="150" rx="8" ry="8" class="node-box"/>
    <rect x="50" y="50" width="200" height="30" rx="8" ry="8" class="node-header-bg"/>
    <text x="150" y="72" text-anchor="middle" class="node-header-text">User Devices</text>
    <text x="60" y="105" class="component-text">Customer Web Portal</text>
    <text x="60" y="130" class="component-text">Staff Web Portal</text>
    <text x="60" y="155" class="component-text">Mobile App</text>
    <text x="60" y="180" class="component-text">(Browsers, Smartphones)</text>


    <rect x="350" y="50" width="200" height="150" rx="8" ry="8" class="node-box"/>
    <rect x="350" y="50" width="200" height="30" rx="8" ry="8" class="node-header-bg"/>
    <text x="450" y="72" text-anchor="middle" class="node-header-text">Edge Services</text>
    <text x="360" y="105" class="component-text">API Gateway</text>
    <text x="360" y="130" class="component-text">Load Balancer</text>
    <text x="360" y="155" class="component-text">Rate Limiting / WAF</text>
    <text x="360" y="180" class="component-text">(e.g., AWS API Gateway, ALB)</text>

    <rect x="650" y="50" width="450" height="400" rx="8" ry="8" class="node-box"/>
    <rect x="650" y="50" width="450" height="30" rx="8" ry="8" class="node-header-bg"/>
    <text x="875" y="72" text-anchor="middle" class="node-header-text">Kubernetes Cluster (Application Layer)</text>
    <use href="#server-rack-icon" x="660" y="60"></use>
    <text x="670" y="125" class="node-label">Microservices Pods</text>

    <rect x="670" y="150" width="120" height="30" rx="4" ry="4" class="component-box"/>
    <text x="730" y="170" text-anchor="middle" class="component-text">User Mgmt Service</text>

    <rect x="800" y="150" width="120" height="30" rx="4" ry="4" class="component-box"/>
    <text x="860" y="170" text-anchor="middle" class="component-text">Order Mgmt Service</text>

    <rect x="930" y="150" width="120" height="30" rx="4" ry="4" class="component-box"/>
    <text x="990" y="170" text-anchor="middle" class="component-text">Production Service</text>

    <rect x="670" y="200" width="120" height="30" rx="4" ry="4" class="component-box"/>
    <text x="730" y="220" text-anchor="middle" class="component-text">Notification Service</text>

    <rect x="800" y="200" width="120" height="30" rx="4" ry="4" class="component-box"/>
    <text x="860" y="220" text-anchor="middle" class="component-text">Reporting Service</text>

    <rect x="930" y="200" width="120" height="30" rx="4" ry="4" class="component-box"/>
    <text x="990" y="220" text-anchor="middle" class="component-text">File Mgmt Service</text>

    <text x="875" y="420" text-anchor="middle" class="component-text">(Node.js, Express/Fastify, TypeScript)</text>

    <rect x="650" y="500" width="200" height="150" rx="8" ry="8" class="db-container"/>
    <rect x="650" y="500" width="200" height="30" rx="8" ry="8" fill="#27ae60"/>
    <text x="750" y="522" text-anchor="middle" class="node-header-text">PostgreSQL DB</text>
    <use href="#db-icon" transform="translate(685, 545)" class="db-icon"></use>
    <text x="750" y="630" text-anchor="middle" class="db-text">(Primary Data)</text>


    <rect x="900" y="500" width="200" height="150" rx="8" ry="8" class="db-container"/>
    <rect x="900" y="500" width="200" height="30" rx="8" ry="8" fill="#27ae60"/>
    <text x="1000" y="522" text-anchor="middle" class="node-header-text">MongoDB</text>
    <use href="#db-icon" transform="translate(935, 545)" class="db-icon"></use>
    <text x="1000" y="630" text-anchor="middle" class="db-text">(File Metadata, GridFS)</text>

    <rect x="650" y="700" width="200" height="150" rx="8" ry="8" class="db-container"/>
    <rect x="650" y="700" width="200" height="30" rx="8" ry="8" fill="#27ae60"/>
    <text x="750" y="722" text-anchor="middle" class="node-header-text">Redis Cache</text>
    <use href="#db-icon" transform="translate(685, 745)" class="db-icon"></use>
    <text x="750" y="830" text-anchor="middle" class="db-text">(Caching, Sessions, Pub/Sub)</text>

    <rect x="900" y="700" width="200" height="150" rx="8" ry="8" class="cloud-storage-container"/>
    <rect x="900" y="700" width="200" height="30" rx="8" ry="8" fill="#3498db"/>
    <text x="1000" y="722" text-anchor="middle" class="node-header-text">AWS S3</text>
    <use href="#cloud-icon" transform="translate(935, 745) scale(0.6)"></use>
    <text x="1000" y="830" text-anchor="middle" class="cloud-storage-text">(Document Storage)</text>

    <text x="1250" y="72" class="node-label">External Services</text>

    <rect x="1150" y="100" width="180" height="30" rx="4" ry="4" class="external-service-box"/>
    <text x="1240" y="120" text-anchor="middle" class="external-service-text">Payment Gateway</text>

    <rect x="1150" y="150" width="180" height="30" rx="4" ry="4" class="external-service-box"/>
    <text x="1240" y="170" text-anchor="middle" class="external-service-text">Email Service</text>

    <rect x="1150" y="200" width="180" height="30" rx="4" ry="4" class="external-service-box"/>
    <text x="1240" y="220" text-anchor="middle" class="external-service-text">SMS Service</text>

    <rect x="1150" y="250" width="180" height="30" rx="4" ry="4" class="external-service-box"/>
    <text x="1240" y="270" text-anchor="middle" class="external-service-text">Shipping APIs</text>


    <line x1="250" y1="125" x2="350" y2="125" class="connection-line"/>
    <text x="300" y="115" class="connection-label">HTTPS</text>

    <line x1="550" y1="170" x2="650" y2="170" class="connection-line"/>
    <text x="600" y="160" class="connection-label">API Calls</text>

    <line x1="750" y1="450" x2="750" y2="500" class="connection-line"/>
    <text x="760" y="475" class="connection-label">SQL</text>

    <line x1="990" y1="450" x2="990" y2="500" class="connection-line"/>
    <text x="1000" y="475" class="connection-label">MongoDB Protocol</text>

    <line x1="750" y1="450" x2="750" y2="700" class="connection-line"/>
    <text x="760" y="575" class="connection-label">Redis Protocol</text>

    <line x1="990" y1="450" x2="990" y2="700" class="connection-line"/>
    <text x="1000" y="575" class="connection-label">S3 API</text>

    <line x1="730" y1="230" x2="1150" y1="165" class="connection-line"/>
    <text x="940" y="190" class="connection-label">Notify</text>

    <line x1="860" y1="180" x2="1150" y1="115" class="connection-line"/>
    <text x="1005" y="140" class="connection-label">Payment Request</text>

    <line x1="990" y1="180" x2="1150" y1="265" class="connection-line"/>
    <text x="1070" y="220" class="connection-label">Shipping Updates</text>

</svg>
